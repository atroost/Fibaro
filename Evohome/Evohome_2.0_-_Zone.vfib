{"name":"Hal","type":"virtual_device","properties":{"deviceIcon":1001,"categories":"[\"climate\"]","currentIcon":"1001","log":"","logTemp":"","mainLoop":"","ui.lbl30Temp.value":"","ui.lblError.value":"","ui.lblMode.value":"FollowSchedule","ui.lblStatus.value":"1","ui.lblTempCurrent.value":"22.5 ","ui.lblTempSet.value":"10 ","ui.lblTempory.value":"","visible":"true","rows":[{"type":"label","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"Current","name":"lblTempCurrent","favourite":false,"main":true}]},{"type":"label","elements":[{"id":2,"lua":false,"waitForResponse":false,"caption":"Set","name":"lblTempSet","favourite":false,"main":false}]},{"type":"button","elements":[{"id":3,"lua":true,"waitForResponse":false,"caption":"-0.5","name":"btnDown","empty":false,"msg":"local selfId = fibaro:getSelfId();\nlocal icon = fibaro:get(selfId, \"deviceIcon\");\nfibaro:call(selfId, \"setProperty\", \"currentIcon\", icon)\n\nif fibaro:get(selfId, \"ui.lblTempory.value\") == \"\" then\n  oldSetTemp = fibaro:get(selfId, \"ui.lblTempSet.value\")\nelse\n  oldSetTemp = fibaro:get(selfId, \"ui.lblTempory.value\")\nend\nnewSetTemp = tonumber(oldSetTemp)-0.5\nfibaro:call(selfId, \"setProperty\", \"ui.lblTempory.value\",newSetTemp..\" \")\n\n\n","buttonIcon":0,"favourite":false,"main":true},{"id":4,"lua":true,"waitForResponse":false,"caption":"+0.5","name":"btnUp","empty":false,"msg":"local selfId = fibaro:getSelfId();\nlocal icon = fibaro:get(selfId, \"deviceIcon\");\nfibaro:call(selfId, \"setProperty\", \"currentIcon\", icon)\n\nif fibaro:get(selfId, \"ui.lblTempory.value\") == \"\" then\n  oldSetTemp = fibaro:get(selfId, \"ui.lblTempSet.value\")\nelse\n  oldSetTemp = fibaro:get(selfId, \"ui.lblTempory.value\")\nend\nnewSetTemp = tonumber(oldSetTemp)+0.5\nfibaro:call(selfId, \"setProperty\", \"ui.lblTempory.value\",newSetTemp..\" \")\n","buttonIcon":0,"favourite":false,"main":false}]},{"type":"label","elements":[{"id":5,"lua":false,"waitForResponse":false,"caption":"","name":"lblTempory","favourite":false,"main":false}]},{"type":"button","elements":[{"id":6,"lua":true,"waitForResponse":false,"caption":"-30","name":"btn30Down","empty":false,"msg":"local selfId = fibaro:getSelfId();\nlocal icon = fibaro:get(selfId, \"deviceIcon\");\nfibaro:call(selfId, \"setProperty\", \"currentIcon\", icon)\n\nif fibaro:get(selfId, \"ui.lbl30Temp.value\") == \"\" or fibaro:get(selfId, \"ui.lbl30Temp.value\") == \" \" then\n  oldSetTime = 0\nelse\n  oldSetTime = fibaro:get(selfId, \"ui.lbl30Temp.value\")\nend\nfibaro:debug(\"x\"..oldSetTime..\"x\")\nnewSetTime = tonumber(oldSetTime)-30\nif newSetTime <= 0 then\n  newSetTime = \"\"\nend\nfibaro:call(selfId, \"setProperty\", \"ui.lbl30Temp.value\",newSetTime..\" \")\n","buttonIcon":0,"favourite":false,"main":false},{"id":7,"lua":true,"waitForResponse":false,"caption":"+30","name":"btn30Up","empty":false,"msg":"local selfId = fibaro:getSelfId();\nlocal icon = fibaro:get(selfId, \"deviceIcon\");\nfibaro:call(selfId, \"setProperty\", \"currentIcon\", icon)\n\nif fibaro:get(selfId, \"ui.lbl30Temp.value\") == \"\" or fibaro:get(selfId, \"ui.lbl30Temp.value\") == \" \" then\n  oldSetTime = 0\nelse\n  oldSetTime = fibaro:get(selfId, \"ui.lbl30Temp.value\")\nend\nnewSetTime = tonumber(oldSetTime)+30\nif newSetTime <= 0 then\n  newSetTime = \"\"\nend\nfibaro:call(selfId, \"setProperty\", \"ui.lbl30Temp.value\",newSetTime..\" \")\n","buttonIcon":0,"favourite":false,"main":false}]},{"type":"label","elements":[{"id":8,"lua":false,"waitForResponse":false,"caption":"Minutes","name":"lbl30Temp","favourite":false,"main":false}]},{"type":"button","elements":[{"id":9,"lua":true,"waitForResponse":false,"caption":"Cancel","name":"btnCancel","empty":false,"msg":"local selfId = fibaro:getSelfId();\nlocal zoneID = fibaro:getName(selfId);\nlocal locationID = fibaro:get(selfId, 'IPAddress');\nlocal sceneID = fibaro:get(selfId, 'TCPPort');\n\nlocal selfId = fibaro:getSelfId();\nlocal icon = fibaro:get(selfId, \"deviceIcon\");\nfibaro:call(selfId, \"setProperty\", \"currentIcon\", icon)\n---fibaro:setGlobal(\"EvohomeAPI\", \"cancel,,\"..locationID..\",\"..zoneID..\",,\")\nfibaro:sleep(2000)\nfibaro:startScene(sceneID, {\"cancel\",\"\",locationID,zoneID,\"\",\"\"})\nfibaro:call(selfId, \"setProperty\", \"ui.lblTempory.value\",\"\")\nfibaro:call(selfId, \"setProperty\", \"ui.lblError.value\", \"Setting data, please wait...\")\n","buttonIcon":0,"favourite":false,"main":false},{"id":10,"lua":true,"waitForResponse":false,"caption":"Set","name":"btnSet","empty":false,"msg":"local selfId = fibaro:getSelfId();\nlocal zoneID = fibaro:getName(selfId);\nlocal locationID = fibaro:get(selfId, 'IPAddress');\nlocal sceneID = fibaro:get(selfId, 'TCPPort');\n\nlocal selfId = fibaro:getSelfId();\nlocal icon = fibaro:get(selfId, \"deviceIcon\");\nfibaro:call(selfId, \"setProperty\", \"currentIcon\", icon)\n\nlocal duration = \"\"\nif fibaro:get(selfId, \"ui.lbl30Temp.value\") ~= \"\" and fibaro:get(selfId, \"ui.lbl30Temp.value\") ~= \" \" then\n  minutes = fibaro:get(selfId, \"ui.lbl30Temp.value\")\n  tempTime = tonumber(minutes)*60\n--  duration = os.date('!%Y-%m-%d %H:%M', os.time()+tempTime)\n  duration = tempTime\n  fibaro:debug(duration)\nend  \n  \nif fibaro:get(selfId, \"ui.lblTempory.value\") == \"\" then\n  fibaro:call(selfId, \"setProperty\", \"ui.lblError.value\", \"No new value set\")\nelse\n  SetTemp = fibaro:get(selfId, \"ui.lblTempory.value\")\n  ---fibaro:setGlobal(\"EvohomeAPI\", \"settemp,,\"..locationID..\",\"..zoneID..\",\"..SetTemp..\",\"..duration)\n  fibaro:sleep(2000)\n  fibaro:debug(zoneID)\n  fibaro:debug(\"*\"..SetTemp..\"*\")\n  fibaro:startScene(sceneID, {\"settemp\",\"\",locationID,zoneID,SetTemp,duration})\n  fibaro:call(selfId, \"setProperty\", \"ui.lblTempory.value\",\"\")\n  fibaro:call(selfId, \"setProperty\", \"ui.lbl30Temp.value\",\"\")\n  fibaro:call(selfId, \"setProperty\", \"ui.lblError.value\", \"Setting data, please wait...\")\nend\n","buttonIcon":0,"favourite":false,"main":false}]},{"type":"label","elements":[{"id":11,"lua":false,"waitForResponse":false,"caption":"Status","name":"lblStatus","favourite":false,"main":false}]},{"type":"label","elements":[{"id":12,"lua":false,"waitForResponse":false,"caption":"Mode","name":"lblMode","favourite":false,"main":false}]},{"type":"label","elements":[{"id":13,"lua":false,"waitForResponse":false,"caption":"","name":"lblError","favourite":false,"main":false}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}